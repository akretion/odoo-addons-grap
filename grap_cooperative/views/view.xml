<?xml version="1.0" encoding="utf-8"?>
<!-- ********************************************************************** -->
<!--    GRAP - Cooperative module for Odoo                                  -->
<!--    Copyright (C) 2014-Today GRAP (http://www.grap.coop)                -->
<!--    @author Sylvain LE GAL (https://twitter.com/legalsylvain)           -->
<!--                                                                        -->
<!--This program is free software: you can redistribute it and/or modify    -->
<!--it under the terms of the GNU Affero General Public License as          -->
<!--published by the Free Software Foundation, either version 3 of the      -->
<!--License, or (at your option) any later version.                         -->
<!--                                                                        -->
<!--This program is distributed in the hope that it will be useful,         -->
<!--but WITHOUT ANY WARRANTY; without even the implied warranty of          -->
<!--MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the           -->
<!--GNU Affero General Public License for more details.                     -->
<!--                                                                        -->
<!--You should have received a copy of the GNU Affero General Public License-->
<!--along with this program.  If not, see <http://www.gnu.org/licenses/>.   -->
<!-- ********************************************************************** -->
<openerp>
    <data>
<!-- View : grap.member -->
        <record id="view_grap_member_search" model="ir.ui.view">
            <field name="model">grap.member</field>
            <field name="arch" type="xml">
                <search> 
                   <field name="name" string="Member" />
                    <field name="college_id"/>
                    <field name="date_capital_entry"/>
                    <filter name="filter_shareholder" string="Shareholder" domain="[('share_number','>', 0)]"/>
                   <group expand='0' string='Group by...'>
                       <filter string='College' context="{'group_by' : 'college_id'}"/>
                   </group>
                </search>
            </field>
        </record>
        
        <record id="view_grap_member_tree" model="ir.ui.view">
            <field name="model">grap.member</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="zip"/>
                    <field name="city"/>
                    <field name="working_email"/>
                    <field name="college_id"/>
                    <field name="date_capital_entry" string="Date" />
                    <field name="share_number" string="Shares" sum="Total of Share"/>
                </tree>
            </field>
        </record>

        <record id="view_grap_member_form" model="ir.ui.view">
            <field name="model">grap.member</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="image" widget="image" class="oe_avatar oe_left"/>
                            </group>
                            <group>
                                <field name="name"/>
                            </group>
                        </group>
                        <group>
                            <group>
                                <separator string="Contact information" colspan="2"/>
                                <field name="working_email"/>
                                <field name="working_phone"/>
                                <field name="street"/>
                                <field name="zip"/>
                                <field name="city"/>
                            </group>
                            <group>
                                <separator string="GRAP information" colspan="2"/>
                                    <field name="college_id" 
                                        options="{'quick_create':false}"/>
                                    <field name="date_capital_entry" 
                                        attrs="{'invisible':[('college_id','=',False)]}"/>
                                    <field name="share_number"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

<!-- View : grap.people -->
        <record id="view_grap_people_search" model="ir.ui.view">
            <field name="model">grap.people</field>
            <field name="arch" type="xml">
                <search> 
                   <field name="name"/>
                   <field name="mandate_ids" string="Mandates" />
                   <field name="working_email" string="Email" />
                   <field name="skills"/>
                   <filter name="filter_related_to_activity" string="Related to an activity" domain="[('activity_ids','!=', False)]"/>
                   <group expand='0' string='Group by...'>
                       <filter string='College' context="{'group_by' : 'college_id'}"/>
                   </group>
                </search>
            </field>
        </record>

        <record id="view_grap_people_tree" model="ir.ui.view">
            <field name="model">grap.people</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="working_email"/>
                    <field name="working_phone"/>
                    <field name="private_phone"/>
                    <field name="mandate_ids" widget="many2many_tags"/>
                    <field name="college_id"/>
                </tree>
            </field>
        </record>

        <record id="view_grap_people_form" model="ir.ui.view">
            <field name="model">grap.people</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group col="4">
                                <group col="2">
                                    <field name="image" widget="image" nolabel="1" height="80" width="80" colspan="2"/>
                                </group>
                                <group col="2">
                                    <h2 colspan="2">
                                        <field name="first_name" nolabel="1" col="1"/>
                                        <field name="last_name" nolabel="1" col="1"/>
                                    </h2>
                                    <field name="catchword" nolabel="1"/>
                                </group>
                            </group>
                            <group>
                                <separator string="People Contact" colspan="2"/>
                                <field name="activity_ids" widget="many2many_tags" />
                            </group>
                        </group>
                        <group>
                            <group col="4">
                                <separator string="People Contact" colspan="4"/>
                                <field name="working_email" colspan="4"/>
                                <field name="working_phone" colspan="4"/>
                                <field name="private_phone" colspan="4"/>
                                <field name="street" colspan="4"/>
                                <field name="zip" colspan="2"/>
                                <field name="city" colspan="2" nolabel="1"/>
                            </group>
                            <group col="4">
                                <separator string="GRAP information" colspan="4"/>
                                <field name="mandate_ids" colspan="4"
                                    widget="many2many_tags"
                                    options="{'quick_create':false}"/>
                                <field name="college_id" colspan="4"
                                    options="{'quick_create':false}"/>
                                <field name="share_number" colspan="2"
                                    attrs="{'invisible':[('college_id','=',False)]}"/>
                                <field name="date_capital_entry" colspan="2"
                                    attrs="{'invisible':[('college_id','=',False)]}"/>
                            </group>
                        </group>
                        <group>
                            <group col="4">
                                <separator string="Skills" colspan="4"/>
                                <field name="skills" widget="html" nolabel="1"/>
                            </group>
                            <group col="4">
                                <separator string="Self Description" colspan="4"/>
                                <field name="description" widget="html" nolabel="1"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_grap_people_kanban" model="ir.ui.view">
            <field name="model">grap.people</field>
            <field name="arch" type="xml">
                <kanban>
                    <field name="name"/>
                        <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_box oe_kanban_color_border">
                                <div style="height:210px;width:190px;overflow:hidden;">
                                    <div style="height:20px;width:190px;border-bottom:1px solid #999999;padding-left:5px;overflow:hidden;">
                                        <a type="edit">
                                            <field name="last_name"/> <field name="first_name"/>
                                        </a>
                                    </div>
                                    <div style="height:190px;width:190px;text-align:center;vertical-align:middle;padding-top: 5px;">
                                        <img t-att-src="kanban_image('grap.people', 'image', record.id.value)" width="180"/>
                                    </div>
                                </div>
                            </div>
                        </t>
                </templates>
                </kanban>
            </field>
        </record>

<!-- View : grap.activity -->
        <record id="view_grap_activity_search" model="ir.ui.view">
            <field name="model">grap.activity</field>
            <field name="arch" type="xml">
                <search> 
                   <field name="code"/>
                   <field name="name"/>
                   <field name="category_ids"/>
                   <field name="hr_interlocutor_id"/>
                   <field name="attendant_interlocutor_id"/>
                   <field name="accountant_interlocutor_id"/>

                   <filter name="filter_validated_working" string="Validated or working" domain="[('state','in', ('validated', 'working'))]"/>
                   <filter name="filter_progress_validated_working" string="In progress, validated or working" domain="[('state','in', ('progress', 'validated', 'working'))]"/>
                   <group expand='0' string='Group by...'>
                       <filter string='Type' context="{'group_by' : 'type_id'}"/>
                       <filter string='College' context="{'group_by' : 'college_id'}"/>
                       <filter string='State' context="{'group_by' : 'state'}"/>
                   </group>
                </search>
            </field>
        </record>

        <record id="view_grap_activity_tree" model="ir.ui.view">
            <field name="model">grap.activity</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="code"/>
                    <field name="name"/>
                    <field name="zip"/>
                    <field name="city"/>
                    <field name="category_ids" widget="many2many_tags"/>
                    <field name="college_id" />
                    <field name="type_id"/>
                    <field name="fte" sum="# of FTE" />
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="view_grap_activity_form" model="ir.ui.view">
            <field name="model">grap.activity</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button name="button_state_previous" string="Previous State" type="object"
                            states="progress,validated,working,obsolete" attrs="{'disabled': 1}"
                            groups="grap_cooperative.res_group_grap_cooperative_manager"/>
                        <button name="button_state_next" string="Next State" type="object"
                            states="draft,progress,validated,working" attrs="{'disable': 1}"
                            groups="grap_cooperative.res_group_grap_cooperative_manager"/>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group>
                            <group col="4">
                                <group col="2">
                                    <field name="image" widget="image" nolabel="1" height="80" width="80" colspan="2"/>
                                </group>
                                <group col="2">
                                    <h2 colspan="2">
                                        <field name="activity_name" nolabel="1"/>
                                    </h2>
                                    <field name="code" colspan="2"/>
                                <field name="category_ids"
                                    widget="many2many_tags"
                                    options="{'quick_create':false}" colspan="2"/>
                                </group>
                            </group>
                            <group>
                                    <field name="fte"/>
                                    <field name="siret"/>
                                    <field name="vat"/>
                                    <field name="date_in"
                                        attrs="{'invisible':[('state','not in',['working','obsolete'])]}"/>
                                    <field name="date_out"
                                        attrs="{'invisible':[('state','not in',['obsolete'])]}"/>
                            </group>
                        </group>
                        <group>
                            <group col="4">
                                <separator string="Activity Contact" colspan="4"/>
                                <field name="working_email" colspan="4"/>
                                <field name="web_site" colspan="4"/>
                                <field name="working_phone" colspan="4"/>
                                <field name="street" colspan="4"/>
                                <field name="zip" colspan="2"/>
                                <field name="city" colspan="2" nolabel="1"/>
                            </group>
                            <group col="4">
                                <separator string="GRAP information" colspan="4"/>
                                    <field name="date_validated" colspan="4"
                                        attrs="{'invisible':[('state','in',['draft','progress'])]}"/>
                                    <field name="type_id"
                                        options="{'quick_create':false}" colspan="4"/>
                                    <field name="college_id" />
                                    <field name="share_number" colspan="2"
                                        attrs="{'invisible':[('college_id','=',False)]}"/>
                                    <field name="date_capital_entry" colspan="2"
                                        attrs="{'invisible':[('college_id','=',False)]}"/>

                            </group>
                        </group>
                        <group>
                            <group>
                                <separator string="Workers" colspan="2"/>
                                <field name="people_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="people_id"/>
                                        <field name="fte"/>
                                    </tree>
                                </field>
                            </group>
                            <group>
                                <separator string="Interlocutors" colspan="2"/>
                                <field name="accountant_interlocutor_id"/>
                                <field name="hr_interlocutor_id"/>
                                <field name="attendant_interlocutor_id"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_grap_activity_kanban" model="ir.ui.view">
            <field name="model">grap.activity</field>
            <field name="arch" type="xml">
                <kanban >
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_box oe_kanban_color_border">
                                <div style="height:150px; width:200px; overflow:hidden;">
                                    <div style="height:40px; width:200px; border-bottom:1px solid #999999;">
                                        <div style="width:200px; text-align:center;">
                                            <a type="edit">
                                                <field name="activity_name"/>
                                            </a>
                                        </div>
                                        <div style="width:200px; text-align:center; font-style:italic;color:gray;">
                                            (<field name="state" />)
                                        </div>
                                    </div>
                                    <div style="height:110px; width:200px;">
                                        <table>
                                            <tr>
                                                <td style="height:110px; width:150px; text-align:center;">
                                                    <div style="padding: 5px 5px 5px 5px;">
                                                        <img t-att-src="kanban_image('grap.activity', 'image', record.id.value)" width="100px"/>
                                                    </div>
                                                </td>
                                                <td style="width:50px;text-align:center;vertical-align:middle;">
                                                    <b><t t-esc="record.fte.string"/></b><br />
                                                    <field name="fte"/><br /><br />
                                                    <b><field name="code"/></b>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

<!-- View : grap.college -->
        <record id="view_grap_college_tree" model="ir.ui.view">
            <field name="model">grap.college</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="percentage"/>
                    <field name="member_count"/>
                </tree>
            </field>
        </record>

        <record id="view_grap_college_form" model="ir.ui.view">
            <field name="model">grap.college</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                            </group>
                            <group>
                                <field name="percentage"/>
                            </group>
                        </group>
                        <notebook colspan="4">
                            <page string="Members">
                                <field name="member_ids"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

<!-- View : grap.mandate -->
        <record id="view_grap_mandate_tree" model="ir.ui.view">
            <field name="model">grap.mandate</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="people_count"/>
                </tree>
            </field>
        </record>

        <record id="view_grap_mandate_form" model="ir.ui.view">
            <field name="model">grap.mandate</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                            </group>
                            <group>
                                <field name="people_count"/>
                            </group>
                        </group>
                        <notebook colspan="4">
                            <page string="People">
                                <field name="people_ids"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        
<!-- View : grap.category -->
        <record id="view_grap_category_tree" model="ir.ui.view">
            <field name="model">grap.category</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="activity_count"/>
                </tree>
            </field>
        </record>

        <record id="view_grap_category_form" model="ir.ui.view">
            <field name="model">grap.category</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                            </group>
                            <group>
                                <field name="activity_count"/>
                            </group>
                        </group>
                        <notebook colspan="4">
                            <page string="Activities">
                                <field name="activity_ids"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

<!-- View : grap.type -->
        <record id="view_grap_type_tree" model="ir.ui.view">
            <field name="model">grap.type</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="activity_count"/>
                </tree>
            </field>
        </record>

        <record id="view_grap_type_form" model="ir.ui.view">
            <field name="model">grap.type</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                            </group>
                            <group>
                                <field name="activity_count"/>
                            </group>
                        </group>
                        <notebook colspan="4">
                            <page string="Activities">
                                <field name="activity_ids"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

<!-- View : grap.todo.task -->
         <record id="todo_task_search" model="ir.ui.view">
            <field name="model">grap.todo.task</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name" string="Name"/>
                    <field name="state"/>
                    <field name="importance"/>
                    <field name="worker_ids"/>
                    <field name="applicant_ids"/>
                    <filter name="filter_todo" string="To do" domain="[('state', 'not in', ('6_canceled', '5_done'))]"/>
                    <group expand="0" string="Group By...">
                        <filter string="Status" domain="[]" context="{'group_by':'state'}"/>
                        <filter string="Importance" domain="[]" context="{'group_by':'importance'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="view_grap_todo_task_tree" model="ir.ui.view">
            <field name="model">grap.todo.task</field>
            <field name="arch" type="xml">
                <tree colors="
                    blue: state in ('1_draft', 'draft');
                    DarkBlue: state in ('2_qualified', 'qualified');
                    brown:state in ('3_in_progress', 'in_progress');
                    green:state in ('4_waiting_migration', 'waiting_migration');
                    black:state in ('5_done', 'done');
                    gray:state in ('6_canceled', 'canceled');">
                    <field name="name"/>
                    <field name="importance"/>
                    <field name="applicant_ids"/>
                    <field name="worker_ids"/>
                    <field name="left_days"/>
                    <field name="stop_date"/>
                    <field name="state" />
                </tree>
            </field>
        </record>

        <record id="view_grap_todo_task_form" model="ir.ui.view">
            <field name="model">grap.todo.task</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button name="button_state_previous" string="Previous State" type="object"
                            states="2_qualified,3_in_progress,4_waiting_migration,5_done,6_canceled" 
                            groups="grap_cooperative.res_group_grap_cooperative_manager"/>
                        <button name="button_state_next" string="Next State" type="object"
                            states="1_draft,2_qualified,3_in_progress,4_waiting_migration,5_done" 
                            groups="grap_cooperative.res_group_grap_cooperative_manager"/>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                                <field name="importance"/>
                                <field name="start_date"/>
                                <field name="stop_date"/>
                            </group>
                            <group>
                                <field name="applicant_ids" widget="many2many_tags"/>
                                <field name="worker_ids" widget="many2many_tags"/>
                                <field name="total_days"/>
                                <field name="made_days"/>
                                <field name="left_days"/>
                            </group>
                        </group>
                        <notebook colspan="4">
                            <page string="Note">
                                <group>
                                    <group>
                                        <field name="note" widget="html"/>
                                        <field name="internal_note" widget="html"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

<!-- View : grap.timesheet -->
        <record id="view_timesheet_search" model="ir.ui.view">
            <field name="model">grap.timesheet</field>
            <field name="arch" type="xml">
                <search>
                    <field name="worker_id"/>
                    <field name="date"/>
                    <filter name="filter_today" string="Today" domain="[('date', '>=', time.strftime('%%Y-%%m-%%d 00:00:00'))]" />
                </search>
            </field>
        </record>

        <record id="view_timesheet_tree" model="ir.ui.view">
            <field name="model">grap.timesheet</field>
            <field name="arch" type="xml">
                <tree editable="top">
                    <field name="type_id"/>
                    <field name="timesheet_group_id"/>
                    <field name="activity_ids" widget="many2many_tags"/>
                    <field name="amount" widget="float_time"/>
                    <field name="name"/>
                    <field name="date"/>
                    <field name="worker_id"/>
                </tree>
            </field>
        </record>


<!-- View : grap.timesheet.type -->
        <record id="view_timesheet_type_tree" model="ir.ui.view">
            <field name="model">grap.timesheet.type</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="display_name"/>
                    <field name="parent_id"/>
                    <field name="active" />
                </tree>
            </field>
        </record>

        <record id="view_timesheet_type_form" model="ir.ui.view">
            <field name="model">grap.timesheet.type</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                                <field name="active" />
                            </group>
                            <group>
                                <field name="parent_id"/>
                                <field name="display_name" />
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

<!-- View : grap.timesheet.group -->
        <record id="view_timesheet_group_tree" model="ir.ui.view">
            <field name="model">grap.timesheet.group</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="activity_ids"/>
                </tree>
            </field>
        </record>

        <record id="view_timesheet_group_form" model="ir.ui.view">
            <field name="model">grap.timesheet.group</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                            </group>
                            <group>
                                <field name="activity_ids" widget="many2many_tags" />
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

<!-- View : grap.timesheet.report -->
        <record id="view_timesheet_report_search" model="ir.ui.view">
            <field name="model">grap.timesheet.report</field>
            <field name="arch" type="xml">
                <search> 
                   <field name="worker_id"/>
                    <field name="type_id"/>
                    <field name="activity_id"/>
                   <group expand='0' string='Group by...'>
                       <filter string='Date' context="{'group_by' : 'date'}"/>
                       <filter string='Worker' context="{'group_by' : 'worker_id'}"/>
                       <filter string='Activity' context="{'group_by' : 'activity_id'}"/>
                       <filter string='Type' context="{'group_by' : 'type_id'}"/>
                   </group>
                </search>
            </field>
        </record>

        <record id="view_timesheet_report_tree" model="ir.ui.view">
            <field name="model">grap.timesheet.report</field>
        <field name="arch" type="xml">
            <tree create="false">
                <field name="date"/>
                <field name="worker_id"/>
                <field name="activity_id"/>
                <field name="type_id"/>
                <field name="name"/>
                <field name="amount" sum="# of Lines"/>
            </tree>
        </field>
    </record>

        <record id="view_timesheet_report_graph" model="ir.ui.view">
            <field name="model">grap.timesheet.report</field>
         <field name="arch" type="xml">
                <graph type="bar">
                    <field name="week"/>
                    <field name="amount" operator="+"/>
                </graph>
         </field>
    </record>

    </data>
</openerp>
